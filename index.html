import React, { useState, useEffect } from 'react';
import { Search, Shield, Target, Brain, Eye, Database, Code, Book, Zap, Activity, AlertTriangle, Play, Copy, Download, Filter, Settings, ChevronDown, ChevronRight, Terminal, Globe, Lock, Users, Clock, TrendingUp, FileText, Layers, Crosshair, Radar } from 'lucide-react';

const EliteHuntingPlatform = () => {
  const [activeTab, setActiveTab] = useState('dashboard');
  const [selectedThreat, setSelectedThreat] = useState(null);
  const [activeQuery, setActiveQuery] = useState('');
  const [queryResults, setQueryResults] = useState([]);
  const [isExecuting, setIsExecuting] = useState(false);
  const [expandedSections, setExpandedSections] = useState({});
  const [notifications, setNotifications] = useState([]);

  // Enhanced threat intelligence data with full functionality
  const threatCategories = {
    'Advanced Persistent Threats': {
      icon: Target,
      color: '#ff4444',
      threats: [
        {
          id: 'apt29',
          name: 'APT29 (Cozy Bear)',
          severity: 'Critical',
          description: 'Russian state-sponsored group using sophisticated spear-phishing and zero-day exploits targeting government and enterprise networks',
          ttps: ['T1566.001', 'T1055', 'T1027', 'T1082', 'T1003.001'],
          indicators: ['beacon patterns', 'cobalt strike', 'domain fronting', 'living off the land'],
          resources: [
            { type: 'MITRE', url: 'https://attack.mitre.org/groups/G0016/', title: 'APT29 Profile' },
            { type: 'CISA Alert', url: '#', title: 'SVR Cyber Operations' },
            { type: 'Yara Rules', url: '#', title: 'CozyBear Detection Rules' }
          ],
          queries: {
            kql: `// APT29 Hunting Query - Suspicious PowerShell and Network Activity
SecurityEvent
| where EventID in (4688, 4689)
| where Process contains "powershell.exe"
| where CommandLine contains_any ("DownloadString", "IEX", "Invoke-Expression", "bypass", "hidden")
| join kind=inner (
    NetworkConnectionEvents
    | where RemoteUrl contains_any ("pastebin", "github", "dropbox")
    | where InitiatingProcessFileName == "powershell.exe"
) on $left.ProcessId == $right.ProcessId
| project TimeGenerated, Computer, Account, CommandLine, RemoteUrl, ProcessId
| summarize count() by Computer, Account, RemoteUrl
| where count_ > 1`,
            splunk: `index=security (EventCode=4688 OR EventCode=4689) Process="*powershell.exe*" (CommandLine="*DownloadString*" OR CommandLine="*IEX*" OR CommandLine="*bypass*")
| join type=inner ProcessId [search index=network RemoteUrl="*pastebin*" OR RemoteUrl="*github*" OR RemoteUrl="*dropbox*" InitiatingProcess="powershell.exe"]
| stats count by Computer, Account, RemoteUrl
| where count > 1`,
            elastic: `{
  "query": {
    "bool": {
      "must": [
        {"terms": {"event.code": ["4688", "4689"]}},
        {"wildcard": {"process.name": "*powershell.exe*"}},
        {"bool": {"should": [
          {"wildcard": {"process.command_line": "*DownloadString*"}},
          {"wildcard": {"process.command_line": "*IEX*"}},
          {"wildcard": {"process.command_line": "*bypass*"}}
        ]}}
      ]
    }
  }
}`
          },
          explanation: `This hunt targets APT29's common techniques including:
          
**PowerShell Abuse**: Looks for obfuscated PowerShell commands with download capabilities
**Network Indicators**: Correlates with suspicious external connections to file-sharing services
**Process Correlation**: Links command execution with network activity using ProcessId
**Behavioral Analysis**: Identifies patterns rather than static IOCs for better detection`
        },
        {
          id: 'apt1',
          name: 'APT1 (Comment Crew)',
          severity: 'High',
          description: 'Chinese military unit conducting cyber espionage operations with focus on intellectual property theft',
          ttps: ['T1566.002', 'T1059.003', 'T1083', 'T1005'],
          indicators: ['RAT backdoors', 'spear phishing', 'credential harvesting'],
          resources: [
            { type: 'Mandiant Report', url: '#', title: 'APT1 Exposing One of China\'s Cyber Espionage Units' },
            { type: 'IOCs', url: '#', title: 'APT1 Indicators of Compromise' }
          ],
          queries: {
            kql: `// APT1 Hunting - RAT Communication Patterns
NetworkConnectionEvents
| where RemotePort in (80, 443, 8080, 9999)
| where TimeGenerated > ago(24h)
| summarize TotalConnections = count(), DistinctPorts = dcount(RemotePort), 
    FirstSeen = min(TimeGenerated), LastSeen = max(TimeGenerated) 
    by Computer, RemoteIP, InitiatingProcessFileName
| where TotalConnections > 50 and DistinctPorts >= 2
| extend Duration = datetime_diff('hour', LastSeen, FirstSeen)
| where Duration > 4
| project Computer, RemoteIP, InitiatingProcessFileName, TotalConnections, Duration`,
            splunk: `index=network RemotePort IN (80,443,8080,9999) earliest=-24h
| stats count as TotalConnections, dc(RemotePort) as DistinctPorts, min(_time) as FirstSeen, max(_time) as LastSeen by Computer, RemoteIP, InitiatingProcess
| where TotalConnections > 50 AND DistinctPorts >= 2
| eval Duration = round((LastSeen - FirstSeen)/3600, 2)
| where Duration > 4`,
            elastic: `{
  "query": {
    "bool": {
      "must": [
        {"terms": {"destination.port": [80, 443, 8080, 9999]}},
        {"range": {"@timestamp": {"gte": "now-24h"}}}
      ]
    }
  },
  "aggs": {
    "connections_by_host": {
      "terms": {"field": "host.name"},
      "aggs": {
        "remote_ips": {
          "terms": {"field": "destination.ip"}
        }
      }
    }
  }
}`
          },
          explanation: `APT1 detection focuses on:
          
**RAT Communication**: Persistent connections to external IPs over multiple ports
**Beaconing Patterns**: Regular communication intervals indicating C2 activity
**Duration Analysis**: Long-running connections suggesting persistent access
**Process Correlation**: Identifies which processes are making external connections`
        }
      ]
    },
    'Ransomware': {
      icon: Lock,
      color: '#ff6b35',
      threats: [
        {
          id: 'conti',
          name: 'Conti Ransomware',
          severity: 'Critical',
          description: 'Sophisticated ransomware-as-a-service operation with double extortion tactics',
          ttps: ['T1486', 'T1490', 'T1082', 'T1083', 'T1057'],
          indicators: ['file encryption', 'shadow copy deletion', 'lateral movement'],
          resources: [
            { type: 'CISA Alert', url: '#', title: 'Conti Ransomware Advisory' },
            { type: 'Decryptor', url: '#', title: 'Conti Decryption Tools' },
            { type: 'YARA', url: '#', title: 'Conti Detection Rules' }
          ],
          queries: {
            kql: `// Conti Ransomware Hunting - File System and Process Activity
SecurityEvent
| where EventID == 4688
| where Process contains_any ("vssadmin.exe", "wbadmin.exe", "bcdedit.exe")
| where CommandLine contains_any ("delete shadows", "delete catalog", "recoveryenabled no")
| union (
    FileCreationEvents
    | where FileName endswith_any (".conti", ".encrypted", ".locked")
    | summarize EncryptedFiles = count() by Computer, InitiatingProcessFileName
    | where EncryptedFiles > 10
)
| project TimeGenerated, Computer, Account, Process, CommandLine, Activity = "Shadow Copy Deletion"`,
            splunk: `(index=security EventCode=4688 (Process="*vssadmin.exe*" OR Process="*wbadmin.exe*" OR Process="*bcdedit.exe*") (CommandLine="*delete shadows*" OR CommandLine="*delete catalog*" OR CommandLine="*recoveryenabled no*"))
OR
(index=filesystem (FileName="*.conti" OR FileName="*.encrypted" OR FileName="*.locked")
| stats count as EncryptedFiles by Computer, InitiatingProcess
| where EncryptedFiles > 10)`,
            elastic: `{
  "query": {
    "bool": {
      "should": [
        {
          "bool": {
            "must": [
              {"term": {"event.code": "4688"}},
              {"bool": {"should": [
                {"wildcard": {"process.name": "*vssadmin.exe*"}},
                {"wildcard": {"process.name": "*wbadmin.exe*"}},
                {"wildcard": {"process.name": "*bcdedit.exe*"}}
              ]}},
              {"bool": {"should": [
                {"wildcard": {"process.command_line": "*delete shadows*"}},
                {"wildcard": {"process.command_line": "*recoveryenabled no*"}}
              ]}}
            ]
          }
        },
        {
          "bool": {
            "must": [
              {"bool": {"should": [
                {"wildcard": {"file.name": "*.conti"}},
                {"wildcard": {"file.name": "*.encrypted"}}
              ]}}
            ]
          }
        }
      ]
    }
  }
}`
          },
          explanation: `Conti ransomware detection strategy:
          
**Shadow Copy Deletion**: Monitors system recovery prevention commands
**File Encryption Patterns**: Detects mass file renaming/encryption activities
**Process Monitoring**: Tracks suspicious system administration tools
**Volume Analysis**: Identifies abnormal file system changes indicating encryption`
        }
      ]
    },
    'Insider Threats': {
      icon: Users,
      color: '#8b5cf6',
      threats: [
        {
          id: 'insider_data',
          name: 'Data Exfiltration',
          severity: 'High',
          description: 'Malicious or negligent insiders accessing and stealing sensitive organizational data',
          ttps: ['T1005', 'T1039', 'T1020', 'T1041'],
          indicators: ['unusual file access', 'large data transfers', 'off-hours activity'],
          resources: [
            { type: 'NIST Guide', url: '#', title: 'Insider Threat Mitigation' },
            { type: 'CERT Guide', url: '#', title: 'Insider Threat Indicators' }
          ],
          queries: {
            kql: `// Insider Threat - Unusual Data Access Patterns
SecurityEvent
| where EventID == 4663 // File access
| where ObjectName contains_any ("sensitive", "confidential", "restricted")
| extend Hour = datetime_part("hour", TimeGenerated)
| where Hour < 6 or Hour > 22 // Off-hours access
| summarize FileAccess = count(), DistinctFiles = dcount(ObjectName) by Account, Computer
| where FileAccess > 20 or DistinctFiles > 10
| join kind=inner (
    SecurityEvent
    | where EventID == 5156 // Network connection
    | where DestinationPort in (21, 22, 443, 80) // FTP, SSH, HTTPS
    | summarize NetworkActivity = count() by Account
) on Account
| project Account, Computer, FileAccess, DistinctFiles, NetworkActivity`,
            splunk: `index=security EventCode=4663 (ObjectName="*sensitive*" OR ObjectName="*confidential*" OR ObjectName="*restricted*")
| eval Hour = strftime(_time, "%H")
| where Hour < 6 OR Hour > 22
| stats count as FileAccess, dc(ObjectName) as DistinctFiles by Account, Computer
| where FileAccess > 20 OR DistinctFiles > 10
| join Account [search index=security EventCode=5156 DestinationPort IN (21,22,443,80) | stats count as NetworkActivity by Account]`,
            elastic: `{
  "query": {
    "bool": {
      "must": [
        {"term": {"event.code": "4663"}},
        {"bool": {"should": [
          {"wildcard": {"file.path": "*sensitive*"}},
          {"wildcard": {"file.path": "*confidential*"}},
          {"wildcard": {"file.path": "*restricted*"}}
        ]}},
        {"bool": {"should": [
          {"range": {"@timestamp": {"format": "hour", "lt": 6}}},
          {"range": {"@timestamp": {"format": "hour", "gt": 22}}}
        ]}}
      ]
    }
  }
}`
          },
          explanation: `Insider threat detection methodology:
          
**Access Pattern Analysis**: Monitors file access during unusual hours
**Data Volume Correlation**: Correlates high-volume file access with network activity
**Behavioral Baseline**: Compares current activity against user's normal patterns
**Multi-Signal Detection**: Combines file access, network, and temporal indicators`
        }
      ]
    },
    'Living Off The Land': {
      icon: Terminal,
      color: '#10b981',
      threats: [
        {
          id: 'lolbins',
          name: 'LOLBins Abuse',
          severity: 'Medium',
          description: 'Attackers using legitimate system binaries for malicious purposes to evade detection',
          ttps: ['T1218', 'T1059.001', 'T1127', 'T1216'],
          indicators: ['powershell abuse', 'wmi usage', 'certutil misuse', 'regsvr32 proxy'],
          resources: [
            { type: 'LOLBAS Project', url: '#', title: 'Living Off The Land Binaries and Scripts' },
            { type: 'Detection Rules', url: '#', title: 'LOLBins Detection Signatures' }
          ],
          queries: {
            kql: `// LOLBins Hunting - Suspicious Usage of Legitimate Tools
SecurityEvent
| where EventID == 4688
| where Process contains_any ("certutil.exe", "regsvr32.exe", "rundll32.exe", "mshta.exe", "bitsadmin.exe")
| where CommandLine contains_any ("urlcache", "download", "http", "javascript:", "vbscript:", "scriptlet")
| extend Technique = case(
    Process contains "certutil" and CommandLine contains "urlcache", "T1105 - File Download",
    Process contains "regsvr32" and CommandLine contains "scriptlet", "T1218.010 - Regsvr32 Proxy",
    Process contains "mshta" and CommandLine contains "javascript", "T1218.005 - MSHTA Abuse",
    Process contains "bitsadmin" and CommandLine contains "download", "T1197 - BITS Job",
    "Unknown LOLBin Technique"
)
| project TimeGenerated, Computer, Account, Process, CommandLine, Technique`,
            splunk: `index=security EventCode=4688 (Process="*certutil.exe*" OR Process="*regsvr32.exe*" OR Process="*rundll32.exe*" OR Process="*mshta.exe*" OR Process="*bitsadmin.exe*") (CommandLine="*urlcache*" OR CommandLine="*download*" OR CommandLine="*http*" OR CommandLine="*javascript:*" OR CommandLine="*scriptlet*")
| eval Technique = case(
    like(Process, "%certutil%") AND like(CommandLine, "%urlcache%"), "T1105 - File Download",
    like(Process, "%regsvr32%") AND like(CommandLine, "%scriptlet%"), "T1218.010 - Regsvr32 Proxy",
    like(Process, "%mshta%") AND like(CommandLine, "%javascript%"), "T1218.005 - MSHTA Abuse",
    1==1, "Unknown LOLBin Technique"
)`,
            elastic: `{
  "query": {
    "bool": {
      "must": [
        {"term": {"event.code": "4688"}},
        {"bool": {"should": [
          {"wildcard": {"process.name": "*certutil.exe*"}},
          {"wildcard": {"process.name": "*regsvr32.exe*"}},
          {"wildcard": {"process.name": "*rundll32.exe*"}},
          {"wildcard": {"process.name": "*mshta.exe*"}},
          {"wildcard": {"process.name": "*bitsadmin.exe*"}}
        ]}},
        {"bool": {"should": [
          {"wildcard": {"process.command_line": "*urlcache*"}},
          {"wildcard": {"process.command_line": "*download*"}},
          {"wildcard": {"process.command_line": "*http*"}},
          {"wildcard": {"process.command_line": "*javascript:*"}}
        ]}}
      ]
    }
  }
}`
          },
          explanation: `LOLBins detection approach:
          
**Binary Monitoring**: Tracks legitimate tools used in suspicious contexts
**Command Analysis**: Analyzes command-line arguments for malicious patterns
**Technique Mapping**: Maps activities to specific MITRE ATT&CK techniques
**Context Awareness**: Considers process execution context and parent processes`
        }
      ]
    }
  };

  const huntingPlaybooks = [
    {
      id: 'network_hunting',
      title: 'Network Traffic Analysis',
      description: 'Advanced network hunting techniques for detecting C2 communications',
      steps: [
        'Baseline normal network patterns',
        'Identify beaconing behavior',
        'Analyze DNS tunneling',
        'Detect domain generation algorithms',
        'Hunt for data exfiltration'
      ],
      queries: 3,
      difficulty: 'Advanced'
    },
    {
      id: 'endpoint_hunting',
      title: 'Endpoint Behavior Analysis',
      description: 'Deep endpoint hunting for persistence and lateral movement',
      steps: [
        'Process tree analysis',
        'Registry persistence hunting',
        'Service manipulation detection',
        'Scheduled task abuse',
        'WMI event consumers'
      ],
      queries: 5,
      difficulty: 'Expert'
    },
    {
      id: 'credential_hunting',
      title: 'Credential Compromise Hunt',
      description: 'Detecting credential theft and abuse techniques',
      steps: [
        'LSASS dumping detection',
        'Kerberoasting identification',
        'Golden ticket hunting',
        'Pass-the-hash detection',
        'DCSync activity'
      ],
      queries: 4,
      difficulty: 'Advanced'
    }
  ];

  const toggleSection = (section) => {
    setExpandedSections(prev => ({
      ...prev,
      [section]: !prev[section]
    }));
  };

  const executeQuery = (query, type) => {
    setIsExecuting(true);
    setActiveQuery(query);
    
    // Simulate query execution
    setTimeout(() => {
      const mockResults = [
        { timestamp: '2025-08-14T10:30:00Z', computer: 'WORKSTATION-01', user: 'john.doe', severity: 'High', description: 'Suspicious PowerShell execution detected' },
        { timestamp: '2025-08-14T10:25:00Z', computer: 'SERVER-02', user: 'admin', severity: 'Critical', description: 'Potential lateral movement detected' },
        { timestamp: '2025-08-14T10:20:00Z', computer: 'WORKSTATION-03', user: 'jane.smith', severity: 'Medium', description: 'Unusual network connection pattern' }
      ];
      setQueryResults(mockResults);
      setIsExecuting(false);
      
      // Add notification
      const notification = {
        id: Date.now(),
        message: `Query executed successfully - ${mockResults.length} results found`,
        type: 'success'
      };
      setNotifications(prev => [notification, ...prev.slice(0, 4)]);
    }, 1500);
  };

  const copyToClipboard = (text) => {
    navigator.clipboard.writeText(text);
    const notification = {
      id: Date.now(),
      message: 'Query copied to clipboard',
      type: 'success'
    };
    setNotifications(prev => [notification, ...prev.slice(0, 4)]);
  };

  const dismissNotification = (id) => {
    setNotifications(prev => prev.filter(n => n.id !== id));
  };

  useEffect(() => {
    // Auto-dismiss notifications after 3 seconds
    const timer = setTimeout(() => {
      setNotifications(prev => prev.slice(0, 3));
    }, 3000);
    return () => clearTimeout(timer);
  }, [notifications]);

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 text-white">
      {/* Notifications */}
      <div className="fixed top-4 right-4 z-50 space-y-2">
        {notifications.map(notification => (
          <div
            key={notification.id}
            className={`px-4 py-2 rounded-lg shadow-lg transition-all duration-300 transform ${
              notification.type === 'success' ? 'bg-green-600' : 'bg-red-600'
            }`}
            onClick={() => dismissNotification(notification.id)}
          >
            <p className="text-sm cursor-pointer">{notification.message}</p>
          </div>
        ))}
      </div>

      {/* Header */}
      <header className="bg-gray-800/80 backdrop-blur-sm border-b border-cyan-500/30 px-6 py-4">
        <div className="flex items-center justify-between">
          <div className="flex items-center space-x-4">
            <div className="flex items-center space-x-2">
              <Crosshair className="w-8 h-8 text-cyan-400" />
              <h1 className="text-2xl font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent">
                ELITE THREAT HUNTER
              </h1>
            </div>
            <div className="flex items-center space-x-1 bg-gray-700/50 px-3 py-1 rounded-full">
              <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
              <span className="text-xs text-gray-300">Live Hunting Active</span>
            </div>
          </div>
          <div className="flex items-center space-x-4">
            <button className="p-2 hover:bg-gray-700 rounded-lg transition-colors">
              <Settings className="w-5 h-5 text-gray-400" />
            </button>
            <button className="p-2 hover:bg-gray-700 rounded-lg transition-colors">
              <Download className="w-5 h-5 text-gray-400" />
            </button>
          </div>
        </div>
      </header>

      <div className="flex h-screen">
        {/* Sidebar Navigation */}
        <aside className="w-64 bg-gray-800/50 backdrop-blur-sm border-r border-cyan-500/30 p-4">
          <nav className="space-y-2">
            {[
              { id: 'dashboard', icon: Activity, label: 'Threat Dashboard' },
              { id: 'hunting', icon: Target, label: 'Active Hunting' },
              { id: 'intelligence', icon: Brain, label: 'Threat Intel' },
              { id: 'playbooks', icon: Book, label: 'Hunt Playbooks' },
              { id: 'queries', icon: Database, label: 'Query Builder' },
              { id: 'resources', icon: Globe, label: 'Resources' }
            ].map(item => (
              <button
                key={item.id}
                onClick={() => setActiveTab(item.id)}
                className={`w-full flex items-center space-x-3 px-3 py-3 rounded-lg transition-all duration-200 ${
                  activeTab === item.id
                    ? 'bg-cyan-600/30 text-cyan-300 border border-cyan-500/50'
                    : 'text-gray-400 hover:text-white hover:bg-gray-700/50'
                }`}
              >
                <item.icon className="w-5 h-5" />
                <span className="font-medium">{item.label}</span>
              </button>
            ))}
          </nav>

          {/* Quick Stats */}
          <div className="mt-8 p-4 bg-gray-900/50 rounded-lg border border-cyan-500/20">
            <h3 className="text-sm font-semibold text-cyan-400 mb-3">Hunt Statistics</h3>
            <div className="space-y-2 text-sm">
              <div className="flex justify-between">
                <span className="text-gray-400">Active Hunts</span>
                <span className="text-white font-medium">7</span>
              </div>
              <div className="flex justify-between">
                <span className="text-gray-400">Threats Detected</span>
                <span className="text-red-400 font-medium">3</span>
              </div>
              <div className="flex justify-between">
                <span className="text-gray-400">Queries Run</span>
                <span className="text-green-400 font-medium">47</span>
              </div>
            </div>
          </div>
        </aside>

        {/* Main Content */}
        <main className="flex-1 overflow-auto">
          {activeTab === 'dashboard' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Threat Hunting Dashboard</h2>
                <p className="text-gray-400">Real-time threat detection and hunting operations center</p>
              </div>

              {/* Active Threats Overview */}
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                {Object.entries(threatCategories).map(([category, data]) => {
                  const IconComponent = data.icon;
                  return (
                    <button
                      key={category}
                      onClick={() => {
                        setActiveTab('intelligence');
                        setSelectedThreat(category);
                      }}
                      className="p-4 bg-gray-800/50 rounded-lg border border-gray-700 hover:border-cyan-500/50 transition-all duration-200 group"
                    >
                      <div className="flex items-center space-x-3 mb-3">
                        <IconComponent className="w-6 h-6" style={{ color: data.color }} />
                        <h3 className="font-semibold text-white group-hover:text-cyan-300">{category}</h3>
                      </div>
                      <div className="text-left">
                        <p className="text-2xl font-bold text-white">{data.threats.length}</p>
                        <p className="text-sm text-gray-400">Active Threats</p>
                      </div>
                    </button>
                  );
                })}
              </div>

              {/* Recent Activity */}
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                  <h3 className="text-xl font-semibold text-white mb-4">Recent Detections</h3>
                  <div className="space-y-3">
                    {[
                      { time: '10:45 AM', threat: 'Suspicious PowerShell', severity: 'High', host: 'WS-001' },
                      { time: '10:30 AM', threat: 'Lateral Movement', severity: 'Critical', host: 'SRV-DB01' },
                      { time: '10:15 AM', threat: 'File Encryption', severity: 'Critical', host: 'WS-007' },
                      { time: '09:55 AM', threat: 'Credential Dump', severity: 'High', host: 'DC-01' }
                    ].map((detection, index) => (
                      <div key={index} className="flex items-center justify-between p-3 bg-gray-900/50 rounded-lg">
                        <div className="flex items-center space-x-3">
                          <div className={`w-3 h-3 rounded-full ${
                            detection.severity === 'Critical' ? 'bg-red-500' : 'bg-orange-500'
                          }`}></div>
                          <div>
                            <p className="text-white font-medium">{detection.threat}</p>
                            <p className="text-sm text-gray-400">{detection.host} • {detection.time}</p>
                          </div>
                        </div>
                        <button className="px-3 py-1 bg-cyan-600 text-white rounded text-sm hover:bg-cyan-700 transition-colors">
                          Investigate
                        </button>
                      </div>
                    ))}
                  </div>
                </div>

                <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                  <h3 className="text-xl font-semibold text-white mb-4">Active Hunt Progress</h3>
                  <div className="space-y-4">
                    {huntingPlaybooks.slice(0, 3).map((playbook, index) => (
                      <div key={index} className="p-3 bg-gray-900/50 rounded-lg">
                        <div className="flex justify-between items-start mb-2">
                          <h4 className="text-white font-medium">{playbook.title}</h4>
                          <span className="text-xs bg-blue-600 text-white px-2 py-1 rounded">{playbook.difficulty}</span>
                        </div>
                        <div className="mb-2">
                          <div className="flex justify-between text-sm mb-1">
                            <span className="text-gray-400">Progress</span>
                            <span className="text-gray-400">{Math.floor(Math.random() * 40) + 60}%</span>
                          </div>
                          <div className="w-full bg-gray-700 rounded-full h-2">
                            <div 
                              className="bg-gradient-to-r from-cyan-500 to-blue-500 h-2 rounded-full" 
                              style={{ width: `${Math.floor(Math.random() * 40) + 60}%` }}
                            ></div>
                          </div>
                        </div>
                        <p className="text-sm text-gray-400">{playbook.queries} queries completed</p>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'intelligence' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Threat Intelligence</h2>
                <p className="text-gray-400">Comprehensive threat profiles with hunting queries and resources</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                {/* Threat Categories */}
                <div className="lg:col-span-1">
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Threat Categories</h3>
                    <div className="space-y-2">
                      {Object.entries(threatCategories).map(([category, data]) => {
                        const IconComponent = data.icon;
                        return (
                          <button
                            key={category}
                            onClick={() => setSelectedThreat(category)}
                            className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-all duration-200 ${
                              selectedThreat === category
                                ? 'bg-cyan-600/30 border border-cyan-500/50'
                                : 'hover:bg-gray-700/50'
                            }`}
                          >
                            <IconComponent className="w-5 h-5" style={{ color: data.color }} />
                            <span className="text-white font-medium">{category}</span>
                            <span className="ml-auto bg-gray-600 text-white text-xs px-2 py-1 rounded-full">
                              {data.threats.length}
                            </span>
                          </button>
                        );
                      })}
                    </div>
                  </div>
                </div>

                {/* Threat Details */}
                <div className="lg:col-span-2">
                  {selectedThreat && (
                    <div className="space-y-4">
                      {threatCategories[selectedThreat].threats.map((threat, index) => (
                        <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                          <div className="flex items-start justify-between mb-4">
                            <div>
                              <h3 className="text-xl font-bold text-white mb-2">{threat.name}</h3>
                              <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                                threat.severity === 'Critical' ? 'bg-red-600/20 text-red-300 border border-red-500/30' :
                                threat.severity === 'High' ? 'bg-orange-600/20 text-orange-300 border border-orange-500/30' :
                                'bg-yellow-600/20 text-yellow-300 border border-yellow-500/30'
                              }`}>
                                {threat.severity}
                              </span>
                            </div>
                            <button 
                              onClick={() => toggleSection(`threat-${index}`)}
                              className="p-2 hover:bg-gray-700 rounded-lg transition-colors"
                            >
                              {expandedSections[`threat-${index}`] ? 
                                <ChevronDown className="w-5 h-5 text-gray-400" /> : 
                                <ChevronRight className="w-5 h-5 text-gray-400" />
                              }
                            </button>
                          </div>

                          <p className="text-gray-300 mb-4">{threat.description}</p>

                          {/* TTPs */}
                          <div className="mb-4">
                            <h4 className="text-sm font-semibold text-cyan-400 mb-2">MITRE ATT&CK TTPs</h4>
                            <div className="flex flex-wrap gap-2">
                              {threat.ttps.map((ttp, ttpIndex) => (
                                <button
                                  key={ttpIndex}
                                  onClick={() => window.open(`https://attack.mitre.org/techniques/${ttp.replace('.', '/')}/`, '_blank')}
                                  className="px-2 py-1 bg-blue-600/20 text-blue-300 rounded text-sm hover:bg-blue-600/30 transition-colors"
                                >
                                  {ttp}
                                </button>
                              ))}
                            </div>
                          </div>

                          {/* Indicators */}
                          <div className="mb-4">
                            <h4 className="text-sm font-semibold text-cyan-400 mb-2">Key Indicators</h4>
                            <div className="flex flex-wrap gap-2">
                              {threat.indicators.map((indicator, indicatorIndex) => (
                                <span
                                  key={indicatorIndex}
                                  className="px-2 py-1 bg-gray-700/50 text-gray-300 rounded text-sm"
                                >
                                  {indicator}
                                </span>
                              ))}
                            </div>
                          </div>

                          {/* Resources */}
                          <div className="mb-4">
                            <h4 className="text-sm font-semibold text-cyan-400 mb-2">Resources</h4>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-2">
                              {threat.resources.map((resource, resourceIndex) => (
                                <button
                                  key={resourceIndex}
                                  onClick={() => {
                                    const notification = {
                                      id: Date.now(),
                                      message: `Opening ${resource.title}`,
                                      type: 'success'
                                    };
                                    setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                                  }}
                                  className="p-2 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors text-left"
                                >
                                  <div className="text-sm font-medium text-white">{resource.type}</div>
                                  <div className="text-xs text-gray-400">{resource.title}</div>
                                </button>
                              ))}
                            </div>
                          </div>

                          {expandedSections[`threat-${index}`] && (
                            <div className="space-y-4 border-t border-gray-700 pt-4">
                              {/* Explanation */}
                              <div>
                                <h4 className="text-sm font-semibold text-cyan-400 mb-2">Hunting Strategy</h4>
                                <div className="bg-gray-900/50 p-4 rounded-lg">
                                  <pre className="text-sm text-gray-300 whitespace-pre-wrap">{threat.explanation}</pre>
                                </div>
                              </div>

                              {/* Queries */}
                              <div>
                                <h4 className="text-sm font-semibold text-cyan-400 mb-2">Detection Queries</h4>
                                <div className="space-y-3">
                                  {Object.entries(threat.queries).map(([platform, query]) => (
                                    <div key={platform} className="bg-gray-900/50 rounded-lg border border-gray-700">
                                      <div className="flex items-center justify-between p-3 border-b border-gray-700">
                                        <h5 className="font-medium text-white uppercase">{platform}</h5>
                                        <div className="flex space-x-2">
                                          <button
                                            onClick={() => copyToClipboard(query)}
                                            className="p-1 hover:bg-gray-700 rounded transition-colors"
                                          >
                                            <Copy className="w-4 h-4 text-gray-400" />
                                          </button>
                                          <button
                                            onClick={() => executeQuery(query, platform)}
                                            className="p-1 hover:bg-gray-700 rounded transition-colors"
                                          >
                                            <Play className="w-4 h-4 text-cyan-400" />
                                          </button>
                                        </div>
                                      </div>
                                      <div className="p-3">
                                        <pre className="text-sm text-gray-300 overflow-x-auto">{query}</pre>
                                      </div>
                                    </div>
                                  ))}
                                </div>
                              </div>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                  )}
                  {!selectedThreat && (
                    <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-8 text-center">
                      <Target className="w-16 h-16 text-gray-600 mx-auto mb-4" />
                      <h3 className="text-xl font-semibold text-white mb-2">Select a Threat Category</h3>
                      <p className="text-gray-400">Choose a threat category from the sidebar to view detailed intelligence and hunting queries</p>
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {activeTab === 'playbooks' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Hunting Playbooks</h2>
                <p className="text-gray-400">Structured hunting methodologies and step-by-step guides</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                {huntingPlaybooks.map((playbook, index) => (
                  <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6 hover:border-cyan-500/50 transition-all duration-200">
                    <div className="flex items-start justify-between mb-4">
                      <h3 className="text-xl font-bold text-white">{playbook.title}</h3>
                      <span className={`px-2 py-1 rounded text-xs font-medium ${
                        playbook.difficulty === 'Expert' ? 'bg-red-600/20 text-red-300' :
                        playbook.difficulty === 'Advanced' ? 'bg-orange-600/20 text-orange-300' :
                        'bg-green-600/20 text-green-300'
                      }`}>
                        {playbook.difficulty}
                      </span>
                    </div>
                    
                    <p className="text-gray-300 mb-4">{playbook.description}</p>
                    
                    <div className="mb-4">
                      <h4 className="text-sm font-semibold text-cyan-400 mb-2">Hunting Steps</h4>
                      <ul className="space-y-1">
                        {playbook.steps.map((step, stepIndex) => (
                          <li key={stepIndex} className="text-sm text-gray-300 flex items-center">
                            <div className="w-1.5 h-1.5 bg-cyan-400 rounded-full mr-2"></div>
                            {step}
                          </li>
                        ))}
                      </ul>
                    </div>
                    
                    <div className="flex items-center justify-between">
                      <div className="text-sm text-gray-400">
                        {playbook.queries} detection queries included
                      </div>
                      <button 
                        onClick={() => {
                          const notification = {
                            id: Date.now(),
                            message: `Loading ${playbook.title} playbook...`,
                            type: 'success'
                          };
                          setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                        }}
                        className="px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors"
                      >
                        Start Hunt
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {activeTab === 'queries' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Query Execution Center</h2>
                <p className="text-gray-400">Execute hunting queries and analyze results in real-time</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                {/* Query Editor */}
                <div className="space-y-4">
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <div className="flex items-center justify-between mb-4">
                      <h3 className="text-lg font-semibold text-white">Query Editor</h3>
                      <div className="flex space-x-2">
                        <button
                          onClick={() => copyToClipboard(activeQuery)}
                          className="p-2 hover:bg-gray-700 rounded transition-colors"
                        >
                          <Copy className="w-4 h-4 text-gray-400" />
                        </button>
                        <button
                          onClick={() => executeQuery(activeQuery, 'kql')}
                          disabled={isExecuting}
                          className="flex items-center space-x-2 px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors disabled:opacity-50"
                        >
                          {isExecuting ? (
                            <>
                              <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                              <span>Executing...</span>
                            </>
                          ) : (
                            <>
                              <Play className="w-4 h-4" />
                              <span>Execute</span>
                            </>
                          )}
                        </button>
                      </div>
                    </div>
                    <textarea
                      value={activeQuery}
                      onChange={(e) => setActiveQuery(e.target.value)}
                      className="w-full h-64 bg-gray-900/50 text-gray-300 p-4 rounded-lg border border-gray-700 font-mono text-sm resize-none focus:outline-none focus:border-cyan-500"
                      placeholder="Enter your hunting query here..."
                    />
                  </div>

                  {/* Quick Query Templates */}
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Quick Templates</h3>
                    <div className="space-y-2">
                      {[
                        {
                          name: 'PowerShell Execution',
                          query: `SecurityEvent\n| where EventID == 4688\n| where Process endswith "powershell.exe"\n| project TimeGenerated, Computer, Account, CommandLine`
                        },
                        {
                          name: 'Failed Logons',
                          query: `SecurityEvent\n| where EventID == 4625\n| summarize count() by Account, Computer\n| sort by count_ desc`
                        },
                        {
                          name: 'Network Connections',
                          query: `NetworkConnectionEvents\n| where TimeGenerated > ago(1h)\n| summarize count() by RemoteIP, RemotePort\n| sort by count_ desc`
                        }
                      ].map((template, index) => (
                        <button
                          key={index}
                          onClick={() => setActiveQuery(template.query)}
                          className="w-full text-left p-3 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors"
                        >
                          <div className="text-white font-medium">{template.name}</div>
                          <div className="text-sm text-gray-400 mt-1">Click to load template</div>
                        </button>
                      ))}
                    </div>
                  </div>
                </div>

                {/* Results Panel */}
                <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                  <div className="flex items-center justify-between mb-4">
                    <h3 className="text-lg font-semibold text-white">Query Results</h3>
                    {queryResults.length > 0 && (
                      <div className="flex items-center space-x-2">
                        <span className="text-sm text-gray-400">{queryResults.length} results</span>
                        <button className="p-2 hover:bg-gray-700 rounded transition-colors">
                          <Download className="w-4 h-4 text-gray-400" />
                        </button>
                      </div>
                    )}
                  </div>

                  {queryResults.length > 0 ? (
                    <div className="space-y-2 max-h-96 overflow-y-auto">
                      {queryResults.map((result, index) => (
                        <div key={index} className="p-3 bg-gray-900/50 rounded border border-gray-700">
                          <div className="flex items-center justify-between mb-2">
                            <span className="text-sm text-gray-400">{result.timestamp}</span>
                            <span className={`px-2 py-1 rounded text-xs ${
                              result.severity === 'Critical' ? 'bg-red-600/20 text-red-300' :
                              result.severity === 'High' ? 'bg-orange-600/20 text-orange-300' :
                              'bg-yellow-600/20 text-yellow-300'
                            }`}>
                              {result.severity}
                            </span>
                          </div>
                          <div className="text-white font-medium mb-1">{result.description}</div>
                          <div className="text-sm text-gray-400">
                            {result.computer} • {result.user}
                          </div>
                        </div>
                      ))}
                    </div>
                  ) : (
                    <div className="text-center py-12">
                      <Database className="w-16 h-16 text-gray-600 mx-auto mb-4" />
                      <p className="text-gray-400">Execute a query to see results here</p>
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {activeTab === 'resources' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Hunting Resources</h2>
                <p className="text-gray-400">Curated collection of threat hunting tools and references</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                {[
                  {
                    category: 'Detection Rules',
                    icon: Shield,
                    color: '#10b981',
                    resources: [
                      { name: 'Sigma Rules', desc: 'Generic detection rules', url: '#' },
                      { name: 'YARA Rules', desc: 'Malware detection patterns', url: '#' },
                      { name: 'Snort Rules', desc: 'Network intrusion detection', url: '#' },
                      { name: 'Suricata Rules', desc: 'Network security monitoring', url: '#' }
                    ]
                  },
                  {
                    category: 'Threat Intelligence',
                    icon: Brain,
                    color: '#8b5cf6',
                    resources: [
                      { name: 'MITRE ATT&CK', desc: 'Adversary tactics and techniques', url: '#' },
                      { name: 'STIX/TAXII', desc: 'Structured threat information', url: '#' },
                      { name: 'OpenIOC', desc: 'Open indicators of compromise', url: '#' },
                      { name: 'ThreatConnect', desc: 'Threat intelligence platform', url: '#' }
                    ]
                  },
                  {
                    category: 'Analysis Tools',
                    icon: Code,
                    color: '#f59e0b',
                    resources: [
                      { name: 'Splunk', desc: 'Security information and event management', url: '#' },
                      { name: 'Elastic Stack', desc: 'Search and analytics engine', url: '#' },
                      { name: 'Microsoft Sentinel', desc: 'Cloud-native SIEM', url: '#' },
                      { name: 'Jupyter Notebooks', desc: 'Interactive analysis environment', url: '#' }
                    ]
                  },
                  {
                    category: 'Malware Analysis',
                    icon: Eye,
                    color: '#ef4444',
                    resources: [
                      { name: 'Ghidra', desc: 'Software reverse engineering', url: '#' },
                      { name: 'IDA Pro', desc: 'Disassembler and debugger', url: '#' },
                      { name: 'x64dbg', desc: 'Open-source debugger', url: '#' },
                      { name: 'Cuckoo Sandbox', desc: 'Automated malware analysis', url: '#' }
                    ]
                  },
                  {
                    category: 'Network Analysis',
                    icon: Globe,
                    color: '#06b6d4',
                    resources: [
                      { name: 'Wireshark', desc: 'Network protocol analyzer', url: '#' },
                      { name: 'Zeek', desc: 'Network security monitor', url: '#' },
                      { name: 'NetworkMiner', desc: 'Network forensic tool', url: '#' },
                      { name: 'TCPdump', desc: 'Command-line packet analyzer', url: '#' }
                    ]
                  },
                  {
                    category: 'Frameworks',
                    icon: Layers,
                    color: '#84cc16',
                    resources: [
                      { name: 'NIST Cybersecurity Framework', desc: 'Cybersecurity best practices', url: '#' },
                      { name: 'SANS Hunt Methodology', desc: 'Structured hunting approach', url: '#' },
                      { name: 'Diamond Model', desc: 'Intrusion analysis methodology', url: '#' },
                      { name: 'Cyber Kill Chain', desc: 'Attack lifecycle model', url: '#' }
                    ]
                  }
                ].map((category, index) => (
                  <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                    <div className="flex items-center space-x-3 mb-4">
                      <category.icon className="w-6 h-6" style={{ color: category.color }} />
                      <h3 className="text-lg font-semibold text-white">{category.category}</h3>
                    </div>
                    <div className="space-y-3">
                      {category.resources.map((resource, resourceIndex) => (
                        <button
                          key={resourceIndex}
                          onClick={() => {
                            const notification = {
                              id: Date.now(),
                              message: `Opening ${resource.name}`,
                              type: 'success'
                            };
                            setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                          }}
                          className="w-full text-left p-3 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors"
                        >
                          <div className="text-white font-medium">{resource.name}</div>
                          <div className="text-sm text-gray-400">{resource.desc}</div>
                        </button>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {activeTab === 'hunting' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Active Hunting Operations</h2>
                <p className="text-gray-400">Monitor and manage ongoing threat hunting activities</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                {/* Active Hunts */}
                <div className="lg:col-span-2 space-y-4">
                  {[
                    {
                      id: 'hunt-001',
                      name: 'Credential Harvesting Investigation',
                      status: 'In Progress',
                      priority: 'High',
                      progress: 75,
                      lastActivity: '2 minutes ago',
                      findings: 3,
                      analyst: 'Sarah Chen'
                    },
                    {
                      id: 'hunt-002', 
                      name: 'Lateral Movement Detection',
                      status: 'In Progress',
                      priority: 'Critical',
                      progress: 45,
                      lastActivity: '15 minutes ago',
                      findings: 7,
                      analyst: 'Mike Torres'
                    },
                    {
                      id: 'hunt-003',
                      name: 'Suspicious PowerShell Activity',
                      status: 'Completed',
                      priority: 'Medium',
                      progress: 100,
                      lastActivity: '1 hour ago',
                      findings: 2,
                      analyst: 'Alex Kim'
                    }
                  ].map((hunt, index) => (
                    <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                      <div className="flex items-start justify-between mb-4">
                        <div>
                          <h3 className="text-lg font-semibold text-white mb-1">{hunt.name}</h3>
                          <div className="flex items-center space-x-4 text-sm">
                            <span className={`px-2 py-1 rounded ${
                              hunt.status === 'In Progress' ? 'bg-blue-600/20 text-blue-300' : 'bg-green-600/20 text-green-300'
                            }`}>
                              {hunt.status}
                            </span>
                            <span className={`px-2 py-1 rounded ${
                              hunt.priority === 'Critical' ? 'bg-red-600/20 text-red-300' :
                              hunt.priority === 'High' ? 'bg-orange-600/20 text-orange-300' :
                              'bg-yellow-600/20 text-yellow-300'
                            }`}>
                              {hunt.priority}
                            </span>
                          </div>
                        </div>
                        <button className="p-2 hover:bg-gray-700 rounded transition-colors">
                          <Settings className="w-5 h-5 text-gray-400" />
                        </button>
                      </div>

                      <div className="mb-4">
                        <div className="flex justify-between text-sm mb-2">
                          <span className="text-gray-400">Progress</span>
                          <span className="text-gray-400">{hunt.progress}%</span>
                        </div>
                        <div className="w-full bg-gray-700 rounded-full h-2">
                          <div 
                            className="bg-gradient-to-r from-cyan-500 to-blue-500 h-2 rounded-full transition-all duration-300" 
                            style={{ width: `${hunt.progress}%` }}
                          ></div>
                        </div>
                      </div>

                      <div className="grid grid-cols-3 gap-4 mb-4">
                        <div className="text-center">
                          <div className="text-2xl font-bold text-white">{hunt.findings}</div>
                          <div className="text-xs text-gray-400">Findings</div>
                        </div>
                        <div className="text-center">
                          <div className="text-2xl font-bold text-cyan-400">{Math.floor(Math.random() * 50) + 10}</div>
                          <div className="text-xs text-gray-400">Queries Run</div>
                        </div>
                        <div className="text-center">
                          <div className="text-2xl font-bold text-green-400">{Math.floor(Math.random() * 1000) + 500}</div>
                          <div className="text-xs text-gray-400">Events Analyzed</div>
                        </div>
                      </div>

                      <div className="flex items-center justify-between text-sm">
                        <div className="text-gray-400">
                          <span className="text-white font-medium">{hunt.analyst}</span> • {hunt.lastActivity}
                        </div>
                        <button 
                          onClick={() => {
                            const notification = {
                              id: Date.now(),
                              message: `Opening hunt details for ${hunt.name}`,
                              type: 'success'
                            };
                            setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                          }}
                          className="px-3 py-1 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors"
                        >
                          View Details
                        </button>
                      </div>
                    </div>
                  ))}
                </div>

                {/* Hunt Controls */}
                <div className="space-y-4">
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Quick Actions</h3>
                    <div className="space-y-3">
                      <button 
                        onClick={() => {
                          const notification = {
                            id: Date.now(),
                            message: 'Starting new hunt operation...',
                            type: 'success'
                          };
                          setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                        }}
                        className="w-full p-3 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors"
                      >
                        <div className="flex items-center space-x-2">
                          <Target className="w-5 h-5" />
                          <span>Start New Hunt</span>
                        </div>
                      </button>
                      <button className="w-full p-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <div className="flex items-center space-x-2">
                          <Radar className="w-5 h-5" />
                          <span>Auto-Hunt Mode</span>
                        </div>
                      </button>
                      <button className="w-full p-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <div className="flex items-center space-x-2">
                          <FileText className="w-5 h-5" />
                          <span>Generate Report</span>
                        </div>
                      </button>
                    </div>
                  </div>

                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Hunt Metrics</h3>
                    <div className="space-y-3">
                      <div className="flex justify-between">
                        <span className="text-gray-400">Active Hunts</span>
                        <span className="text-white font-medium">3</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">Total Findings</span>
                        <span className="text-cyan-400 font-medium">12</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">False Positives</span>
                        <span className="text-yellow-400 font-medium">2</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">Success Rate</span>
                        <span className="text-green-400 font-medium">85%</span>
                      </div>
                    </div>
                  </div>

                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Recent Alerts</h3>
                    <div className="space-y-2">
                      {[
                        { time: '2m ago', alert: 'Suspicious process creation', severity: 'High' },
                        { time: '5m ago', alert: 'Unusual network traffic', severity: 'Medium' },
                        { time: '8m ago', alert: 'Failed authentication spike', severity: 'High' },
                        { time: '12m ago', alert: 'Registry modification', severity: 'Low' }
                      ].map((alert, index) => (
                        <div key={index} className="p-2 bg-gray-900/50 rounded text-sm">
                          <div className="flex items-center justify-between">
                            <span className="text-white">{alert.alert}</span>
                            <span className={`text-xs ${
                              alert.severity === 'High' ? 'text-orange-400' :
                              alert.severity === 'Medium' ? 'text-yellow-400' :
                              'text-gray-400'
                            }`}>
                              {alert.severity}
                            </span>
                          </div>
                          <div className="text-gray-400 text-xs">{alert.time}</div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}
        </main>
      </div>

      {/* Query Execution Modal */}
      {isExecuting && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
          <div className="bg-gray-800 rounded-lg border border-gray-700 p-6 max-w-md w-full mx-4">
            <div className="text-center">
              <div className="w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
              <h3 className="text-lg font-semibold text-white mb-2">Executing Query</h3>
              <p className="text-gray-400">Analyzing security events and generating results...</p>
              <div className="mt-4 bg-gray-900/50 rounded p-3">
                <div className="text-sm text-gray-300 font-mono">
                  {activeQuery.slice(0, 100)}...
                </div>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Footer */}
      <footer className="bg-gray-800/50 backdrop-blur-sm border-t border-cyan-500/30 px-6 py-4">
        <div className="flex items-center justify-between text-sm">
          <div className="flex items-center space-x-4 text-gray-400">
            <span>© 2025 Elite Threat Hunter Platform</span>
            <span>•</span>
            <span>Last updated: {new Date().toLocaleString()}</span>
          </div>
          <div className="flex items-center space-x-4">
            <div className="flex items-center space-x-2">
              <div className="w-2 h-2 bg-green-400 rounded-full"></div>
              <span className="text-gray-400">All systems operational</span>
            </div>
            <button className="text-cyan-400 hover:text-cyan-300 transition-colors">
              System Status
            </button>
          </div>
        </div>
      </footer>
    </div>
  );
};

export default EliteHuntingPlatform;
